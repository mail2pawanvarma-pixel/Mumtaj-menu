<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Mumtaj Biryani</title>
<style>
  body {
    margin:0;
    font-family:"Poppins",sans-serif;
    background:#f8f9fa;
    color:#333;
  }
  header {
    background:#8B0000;
    color:#fff;
    text-align:center;
    padding:20px 10px;
    font-size:24px;
    letter-spacing:1px;
  }
  .menu {
    display:grid;
    grid-template-columns:1fr;
    gap:15px;
    padding:20px;
    max-width:600px;
    margin:auto;
  }
  .item {
    background:#fff;
    border-radius:12px;
    box-shadow:0 2px 8px rgba(0,0,0,0.1);
    overflow:hidden;
  }
  .item img {
    width:100%;
    height:180px;
    object-fit:cover;
  }
  .details {
    padding:15px;
  }
  .details h3 {
    margin:0 0 5px;
    color:#8B0000;
  }
  .details p {
    margin:3px 0;
    color:#555;
  }
  .details input {
    width:70px;
    padding:5px;
    border:1px solid #ccc;
    border-radius:5px;
    margin-top:5px;
  }
  label {font-size:14px;}
  .order-section {
    max-width:600px;
    margin:20px auto;
    padding:0 20px 40px;
  }
  input[type="datetime-local"] {
    width:100%;
    padding:10px;
    margin-top:10px;
    border-radius:8px;
    border:1px solid #ccc;
    font-size:16px;
  }
  button {
    width:100%;
    background:#8B0000;
    color:#fff;
    border:none;
    padding:14px;
    font-size:16px;
    border-radius:8px;
    cursor:pointer;
    margin-top:20px;
  }
  button:hover {background:#a4161a;}
</style>
</head>
<body>

<header>Mumtaj Biryani</header>
<div id="menu" class="menu"></div>

<div class="order-section">
  <label for="datetime">Delivery Date & Time:</label>
  <input type="datetime-local" id="datetime" required>
  <button onclick="sendOrder()">Send Order on WhatsApp</button>
</div>

<script>
// Google Sheet link converted to CSV
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTP0KJ_WjnHoYVec0BEQQkWw9ZmiQNquh-WapC5hAb6sSdqAmCOOIyeKG6UNG7R83w3zvS-0todyla3/pub?output=csv";
const whatsappNumber = "918319100020"; // includes country code

async function loadMenu() {
  try {
    const res = await fetch(sheetURL);
    const text = await res.text();
    const rows = text.split("\n").map(r => r.split(","));
    const menuContainer = document.getElementById("menu");
    for (let i = 1; i < rows.length; i++) {
      const [item, desc, price, image] = rows[i];
      if (!item) continue;
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        ${image ? `<img src="${image.trim()}" alt="${item}">` : ""}
        <div class="details">
          <h3>${item}</h3>
          <p>${desc}</p>
          <p><strong>â‚¹${price}</strong></p>
          <label>Qty: <input type="number" min="0" value="0" id="qty-${i}"></label>
        </div>`;
      div.dataset.name = item;
      div.dataset.price = price;
      menuContainer.appendChild(div);
    }
  } catch (e) {
    document.getElementById("menu").innerHTML =
      "<p style='text-align:center;color:red;'>Unable to load menu. Check sheet link.</p>";
  }
}

function sendOrder() {
  const items = document.querySelectorAll(".item");
  let orderList = [];
  items.forEach((it, i) => {
    const qty = document.getElementById(`qty-${i+1}`);
    if (qty && qty.value > 0) {
      orderList.push(`${it.dataset.name} x${qty.value}`);
    }
  });
  if (orderList.length === 0) {
    alert("Please select at least one item.");
    return;
  }
  const datetime = document.getElementById("datetime").value;
  if (!datetime) {
    alert("Please select delivery date and time.");
    return;
  }
  const msg = `New Order from Mumtaj Biryani:%0A${orderList.join("%0A")}%0A%0ADelivery: ${datetime}`;
  window.open(`https://wa.me/${whatsappNumber}?text=${msg}`, "_blank");
}

loadMenu();
</script>

</body>
</html>