<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Mumtaj Biryani</title>

<style>
  body {
    margin:0;
    font-family:Arial, sans-serif;
    background:#fafafa;
  }

  header {
    background:#8B0000;
    color:#fff;
    padding:20px;
    text-align:center;
    font-size:24px;
    font-weight:bold;
  }

  .menu {
    padding:20px;
    max-width:650px;
    margin:auto;
    display:grid;
    gap:18px;
  }

  .item {
    background:#fff;
    border-radius:12px;
    box-shadow:0 3px 8px rgba(0,0,0,0.1);
    overflow:hidden;
  }

  .item img {
    width:100%;
    height:180px;
    object-fit:cover;
  }

  .details {
    padding:15px;
  }

  .details h3 {
    margin:0;
    font-size:20px;
    color:#8B0000;
  }

  .details p {
    margin:5px 0;
    color:#444;
  }

  input[type=number] {
    width:70px;
    padding:6px;
    border:1px solid #aaa;
    border-radius:6px;
  }

  .order-box {
    max-width:650px;
    margin:25px auto;
    padding:0 20px 40px;
  }

  input[type=datetime-local] {
    width:100%;
    padding:12px;
    margin-top:15px;
    border:1px solid #ccc;
    border-radius:8px;
    font-size:16px;
  }

  button {
    margin-top:20px;
    width:100%;
    padding:14px;
    font-size:18px;
    background:#8B0000;
    color:#fff;
    border:none;
    border-radius:8px;
    cursor:pointer;
  }

  button:hover {background:#a4161a;}

  /* Popup box */
  .popup-bg {
    position:fixed;
    top:0;left:0;right:0;bottom:0;
    background:rgba(0,0,0,0.6);
    display:none;
    justify-content:center;
    align-items:center;
    z-index:9999;
  }

  .popup-box {
    background:white;
    padding:25px;
    border-radius:12px;
    width:85%;
    max-width:350px;
    text-align:center;
    box-shadow:0 4px 10px rgba(0,0,0,0.2);
  }

  .popup-box h2 {
    margin-top:0;
    color:#8B0000;
  }

  .popup-box button {
    background:#8B0000;
    padding:10px 20px;
    border-radius:8px;
    border:none;
    color:white;
    font-size:16px;
    cursor:pointer;
    margin-top:15px;
  }
</style>
</head>

<body>

<header>Mumtaj Biryani</header>

<div id="menu" class="menu"></div>

<div class="order-box">
  <label>Select Delivery Date & Time:</label>
  <input type="datetime-local" id="datetime">
  <button onclick="sendOrder()">Send Order on WhatsApp</button>
</div>

<!-- Thank You Popup -->
<div id="popup" class="popup-bg">
  <div class="popup-box">
    <h2>Thank You!</h2>
    <p>Your order has been sent to Mumtaj Biryani. We will confirm shortly on WhatsApp.</p>
    <button onclick="closePopup()">OK</button>
  </div>
</div>


<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTP0KJ_WjnHoYVec0BEQQkWw9ZmiQNquh-WapC5hAb6sSdqAmCOOIyeKG6UNG7R83w3zvS-0todyla3/pub?output=csv";
const whatsappNumber = "918319100020";

async function loadMenu() {
  const res = await fetch(sheetURL);
  const text = await res.text();
  const rows = text.split("\n").map(r => r.split(","));

  const menuContainer = document.getElementById("menu");

  for (let i = 1; i < rows.length; i++) {
    let [item, desc, price, image] = rows[i];

    if (!item) continue;

    if (image) image = image.replace(/"/g, "").trim();

    const box = document.createElement("div");
    box.className = "item";

    box.innerHTML = `
      ${image ? `<img src="${image}" onerror="this.style.display='none'">` : ""}
      <div class="details">
        <h3>${item}</h3>
        <p>${desc}</p>
        <p><strong>â‚¹${price}</strong></p>
        Qty: <input id="qty-${i}" type="number" value="0" min="0">
      </div>
    `;

    box.dataset.name = item;
    menuContainer.appendChild(box);
  }
}

function sendOrder() {
  const items = document.querySelectorAll(".item");
  let orderList = [];

  items.forEach((it, i) => {
    const qty = document.getElementById(`qty-${i+1}`);
    if (qty && qty.value > 0) {
      orderList.push(`${it.dataset.name} x${qty.value}`);
    }
  });

  if (orderList.length === 0) {
    alert("Please select at least one item.");
    return;
  }

  const dt = document.getElementById("datetime").value;
  if (!dt) {
    alert("Please select delivery date & time.");
    return;
  }

  const message =
    `New Order (Mumtaj Biryani):%0A${orderList.join("%0A")}%0A%0ADelivery: ${dt}`;

  // Open WhatsApp
  window.open(`https://wa.me/${whatsappNumber}?text=${message}`, "_blank");

  // Show popup AFTER opening WhatsApp
  setTimeout(() => {
    document.getElementById("popup").style.display = "flex";
  }, 1000);
}

function closePopup() {
  document.getElementById("popup").style.display = "none";
}

loadMenu();
</script>

</body>
</html>